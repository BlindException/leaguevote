<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous" />
         <script src="https://www.google.com/recaptcha/api.js" async defer></script>
     
    <title>Create A New Account</title>
    <style></style>
    <link href="https://robertprockjr.com/leaguevote/CSS/SiteStyle.css" rel="stylesheet" />
</head>
<body>
<div class="container mx-auto mt-3 mb-5">
        <div class="row">
            <header class="bg-white p-3 my-5">
                <h1  class="w-25 p-5 mb-4 mt-3 ms-3 text-start rounded-circle">LeagueVote
                </h1>
            </header>
        </div>
    </div>
    
    <div class="container mx-auto my-5">
        <main role="main">
            <div class="row">
                <h2 class="shadow mt-2 mb-5 rounded-pill text-center w-50 p-4 mx-auto">Create An Account</h2>
                </div>
        <form  method="post" action="https://robertprockjr.com/leaguevote/Controllers/Index/Register.php" class="needs-validation">
            <div class="row"><label for="firstName" class="form-label">Enter your First name:</label></div>
            <div class="row"><input type="text" id="firstName" name="FirstName" required  class="form-control"/><div class = "valid-feedback">&check;</div><div class = "invalid-feedback">╘Enter Valid First Name!</div></div>
            <div class="row"><label for="lastName" class="form-label">Enter Last Name:</label>            </div>
            <div class="row"><input type="text" id="lastName" name="LastName" required  class="form-control"/><div class = "valid-feedback">&check;</div><div class = "invalid-feedback">╘Enter Valid Last Name!</div></div>
            <div class="row"><label for="email" class="form-label">Enter Email:</label></div>
            <div class="row"><input type="email" id = "email" name="Email" required onkeyup="checkEmail(this.value)" onblur="checkEmail(this.value)"  class ="form-control"/><div class = "valid-feedback">&check;</div><div class = "invalid-feedback">╘Enter Valid Email Address!</div></div>
                            <div id="emailMessage" style="display:none;"><span>An account already exists with this email, <a href = "#">forgot your username</a>?</span><br/><span><a href="https://robertprockjr.com/leaguevote/views/login.php">Login here</a></span></div>
                
                   <div class="row"><label for="username" class="form-label">Enter Username:</label></div>
            <div class="row"><input type="text" id="username" name="Username" required onkeyup="checkUser(this.value)" onblur="checkUser(this.value)"  class="form-control" pattern="(?=^.*).{6,255}$" title="Username must be at least 6 characters."/><div class = "valid-feedback">&check;</div><div class = "invalid-feedback">╘Enter Valid Username! It must be at least 6 characters long.</div></div>
            <div id="userMessage" style="display:none;"><span>An account already exists with this username,  choose another username or did you <a href = "#">forget your password</a>?</span><br/><span><a href="https://robertprockjr.com/leaguevote/views/login.php">Login here</a></span></div>
            
    <div class="row">
        <div class="col-2"><span class="align-middle"><label class="form-check-label">Show Password<input type="checkbox" id="createPasswordCB"class="form-check" /></label></span></div>
        
    <div class="col-10">
        <div class="row"><label for="password" class="form-label">Enter Password:</label></div>
            <div class="row"><input type="password" id="password" name="Password" required onkeyup="matchPassword()" class="form-control"pattern="(?=^.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,255}$" title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters" /><div class = "valid-feedback">&check;</div><div class = "invalid-feedback">╘Enter Valid Password! It must be at least 8 characters, contain 1 uppercase letter, 1 lowercase letter and 1 number.</div></div>
        
            <div class="row"><label for="confirm" class="form-label">Confirm Password:</label></div>
            <div class="row"><input type="password" id="confirm" required onkeyup="matchPassword()" class="form-control" pattern="(?=^.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,255}$" title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters" /><div class = "valid-feedback">&check;</div><div class = "invalid-feedback">╘Enter Valid Password! It must be at least 8 characters, contain 1 uppercase letter, 1 lowercase letter and 1 number.</div></div>
                    <div id="passwordMessage" style="display:none;"><p>Your Passwords do not match!</p></div>
        </div>
    </div>
        
    <div class="row"><div class="g-recaptcha" data-sitekey="6LedXNEdAAAAAKsfvdo5r7A95X6jfwWh-MYfXSIU" data-callback="validateCaptcha"></div>        <input type="text" id="gResponse" name="GResponse" hidden />        </div>
            <div class="row"><button id="submit" type="submit" class="btn btn-success">Submit</button></div> 
        
    </form>
            </main>
        
    </div>
    <div class="container-fluid mt-5 mb-3">
        <footer class="bg-white text-center text-dark p-3 my-5 w-100">
            
            <div class="row">
                <small>&copy;2022 BlindException</small>
            </div>
        </footer>
    </div>        
    <script src="https://code.jquery.com/jquery-
3.4
.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
        crossorigin="anonymous"></script>
</body>
</html>
<script >
    
    function matchPassword() {
        
        var password = $('#password').val();
        var confirm = $('#confirm').val();
        if (confirm == '' && password == '') {
            return;
        }
    var submit = $('#submit');
        var message = $('#passwordMessage');
        message.hide();
        if (confirm=== password) {
                                submit.attr('disabled', false);
            message.hide();
        } else
        {
                submit.attr('disabled', true);
            message.show();
            message.focus();
            message.fadeOut(10000);
                                }
    }
    function checkEmail(email){
       
       if(email== ''){
           $('#email').html('');
           return;
        }
        var submit = $('#submit');
        var emailMessage = $('#emailMessage');
        emailMessage.hide();
        
       $.ajax({
           url: 'https://robertprockjr.com/leaguevote/Controllers/index/Register.php?q=' + email,
           beforeSend: function (xhr) {
               xhr.overrideMimeType("text/plain; charset=x-user-defined");
           }
       })
           .done(function (data) {
               
               data = $.parseJSON(data);
               if (data > 0)
               {
                   submit.attr('disabled', true);
                   emailMessage.show();
                   emailMessage.fadeOut(10000);
               } else {
                   submit.attr('disabled', false);
                   emailMessage.hide();
               }
           })
           .fail(function () {
               //alert('Please enter a valid zipp code or City, State/Region')
           })

    }
    function checkUser(username){
       
       if(username== ''){
           $('#username').html('');
           return;
        }
        var userMessage = $('#userMessage');
        userMessage.hide();
       $.ajax({
           url: '../../Controllers/index/Register.php?u=' + username,
           beforeSend: function (xhr) {
               xhr.overrideMimeType("text/plain; charset=x-user-defined");
           }
       })
           .done(function (data) {
               var submit = $('#submit');
               data = $.parseJSON(data);
               if (data > 0)
               {
                   submit.attr('disabled', true);
                   userMessage.show();
                   userMessage.fadeOut(10000);
               } else {
                   submit.attr('disabled', false);
                   userMessage.hide();
               }
           })
           .fail(function () {
               //alert('Please enter a valid zipp code or City, State/Region')
           })

    }
    
        var createCB = $('#createPasswordCB');
        var password = $('#password');
    var confirm = $('#confirm');
    
    createCB.on('click', function () {
        if (createCB.is(":checked") == true) {
            password.prop('type', 'text');
            confirm.prop('type', 'text');
            console.log("checked");
        }
        if (createCB.is(":checked") == false) {
                        password.prop('type', 'password');
            confirm.prop('type', 'password');
            console.log("Not checked");
        }
        $(':reset').on('click', function () {
            password.prop('type', 'password');
            confirm.prop('type', 'password');
        });
    })

    var validateCaptcha = function(token) {
                $('#gResponse').val(token);
    }
    </script>